<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Web Resource</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="./src/css/custom.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="WebResource.html"><strong aria-hidden="true">1.</strong> Web application using Django</a></li><li class="chapter-item expanded "><a href="Deployment/Deployment.html"><strong aria-hidden="true">2.</strong> Deployment</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Deployment/introduction.html"><strong aria-hidden="true">2.1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="Deployment/installation.html"><strong aria-hidden="true">2.2.</strong> Installation</a></li><li class="chapter-item expanded "><a href="Deployment/djangoInitiate.html"><strong aria-hidden="true">2.3.</strong> Setting Django app</a></li><li class="chapter-item expanded "><a href="Deployment/EBinitiate.html"><strong aria-hidden="true">2.4.</strong> Setting up Elastic Beanstalk</a></li><li class="chapter-item expanded "><a href="Deployment/deployment_successful.html"><strong aria-hidden="true">2.5.</strong> Verifying deployment</a></li><li class="chapter-item expanded "><a href="Deployment/domain_route53.html"><strong aria-hidden="true">2.6.</strong> Change Domain name</a></li></ol></li><li class="chapter-item expanded "><a href="Django/Django.html"><strong aria-hidden="true">3.</strong> Django development</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Django/djangoCommands.html"><strong aria-hidden="true">3.1.</strong> Basic commands</a></li><li class="chapter-item expanded "><a href="Django/djangoCheatsheet.html"><strong aria-hidden="true">3.2.</strong> Cheatsheet</a></li><li class="chapter-item expanded "><a href="Django/djangoProjectOverview.html"><strong aria-hidden="true">3.3.</strong> Project Overview</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Django/djangoSettings.html"><strong aria-hidden="true">3.3.1.</strong> settings</a></li><li class="chapter-item expanded "><a href="Django/djangoTemplates.html"><strong aria-hidden="true">3.3.2.</strong> templates</a></li><li class="chapter-item expanded "><a href="Django/djangoUrls.html"><strong aria-hidden="true">3.3.3.</strong> urls</a></li></ol></li><li class="chapter-item expanded "><a href="Django/djangoModule.html"><strong aria-hidden="true">3.4.</strong> Add module</a></li><li class="chapter-item expanded "><a href="Django/djangoDatabase.html"><strong aria-hidden="true">3.5.</strong> Add files to database</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Web Resource</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="web-application-using-django"><a class="header" href="#web-application-using-django">Web application using Django</a></h1>
<p>This is a guide to developing a web application using Django followed by deployment on AWS Elastic Beanstalk.</p>
<p>The app can be access through <a href="isoforms.com">www.isoforms.com</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="deployment"><a class="header" href="#deployment">Deployment</a></h1>
<p>There are multiple platforms to host a website, such as DigitalOcean, Heroku etc.
For the purpose of this site to ease database upload, we have chosen to use the AWS Elastic Beanstalk.</p>
<p>This will involve:</p>
<ol>
<li>Installation: setting up the Elastic Beanstalk command line interface (EB CLI) on Windows.</li>
<li>Setting the Django app on Windows.</li>
<li>Setting up the Elastic Beanstalk on Windows.</li>
<li>Deployment</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="setting-up-the-elastic-beanstalk-command-line-interface-eb-cli"><a class="header" href="#setting-up-the-elastic-beanstalk-command-line-interface-eb-cli">Setting up the Elastic Beanstalk command line interface (EB CLI)</a></h1>
<h2 id="introduction"><a class="header" href="#introduction">Introduction</a></h2>
<p>While the application can be configured and deployed directly on the AWS web, the command line through windows allows more flexilibty and version control with GitHub. A step-to-step guide from AWS can be found on <a href="https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/create-deploy-python-django.html%3E">create-deploy-python-django doc</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h2 id="installation"><a class="header" href="#installation">Installation</a></h2>
<ol>
<li>
<p>Install pre-requisite packages:</p>
<ul>
<li>Download <a href="https://www.python.org/downloads/">python</a> for Windows.</li>
</ul>
<blockquote>
<p><strong>Important:</strong> Ensure to check "add to path" on pop-up window</p>
</blockquote>
<ul>
<li>Download <a href="https://git-scm.com/download/win">git</a> for Windows.</li>
</ul>
</li>
<li>
<p>Type command prompt on Windows search.
<br>
<br>
<img src="Deployment/../Images/commandPrompt.jpg" alt="CommandPrompt" /></p>
</li>
</ol>
<p>This will open a new Windows terminal.</p>
<ol start="3">
<li>
<p>In the terminal, install eb command line interface. On the command prompt, type:</p>
<pre><code class="language-shell">pip install virtualenv
git clone https://github.com/aws/aws-elastic-beanstalk-cli-setup.git
python .\aws-elastic-beanstalk-cli-setup\scripts\ebcli_installer.py
eb
</code></pre>
</li>
<li>
<p>Install aws.</p>
<pre><code class="language-shell">pip install awscli
aws --version
</code></pre>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h2 id="create-django-project-and-environment"><a class="header" href="#create-django-project-and-environment">Create django project and environment</a></h2>
<p>On the Windows terminal:</p>
<ol>
<li>
<p>In the destination folder, create and activate the environment:</p>
<pre><code class="language-shell"># change directory to folder
cd C:\Users\sl693\Dropbox\Scripts

# create environment
python -m venv isoVis_env

# activate environment
isoVis_env\Scripts\activate
</code></pre>
</li>
<li>
<p>Install packages to run Django using pip (and any others for plotting etc)</p>
<pre><code class="language-shell"># install Django
pip install Django

# others
pip install django-import-export
pip install pandas
pip install matplotlib
pip install seaborn
pip install plotly
</code></pre>
</li>
<li>
<p>Initiate the django project:</p>
<pre><code class="language-shell">django-admin startproject isoVisDev 
</code></pre>
<blockquote>
<p><strong>Note:</strong> Here isoVisDev is the name of the project. Replace "isoVisDev" with the name of project.</p>
</blockquote>
<p>This will create the following folder and structure:</p>
<pre><code class="language-markdown">isoVisDev
├───manage.py    
└───isoVisDev
     ├───asgi.py
     ├───settings.py
     ├───urls.py
     └───wsgi.py 
</code></pre>
</li>
<li>
<p>Create a requirements.txt (for installing the environment on AWS). The requirements.txt lists all the packages installed in the environment.</p>
<pre><code class="language-shell">cd isoVisDev
python manage.py runserver
pip freeze &gt; requirements.txt
</code></pre>
<p>The requirements.txt will be in the isoVisDev folder as shown in the tree structure below:</p>
<pre><code class="language-markdown"> isoVisDev
 ├───manage.py
 ├───requirements.txt
 └───isoVisDev  
</code></pre>
</li>
<li>
<p>Create a configuration file for django in the .ebextensions folder.</p>
<pre><code class="language-shell">mkdir .ebextensions
deactivate
</code></pre>
<p>Manually create the djang.config and copy the following text in the file:</p>
<pre><code class="language-yaml">option_settings:
aws:elasticbeanstalk:container:python:
WSGIPath: isoVisDev.wsgi:application
</code></pre>
<blockquote>
<p><strong>Important:</strong> Ensure that the WSGIPath is updated to the name of the app (isoVisDev.wsgi refers to the wsgi.py script in the isoVisDev folder)
Note the updated folder structure:</p>
</blockquote>
<pre><code class="language-markdown"> isoVisDev
 ├───manage.py
 ├───requirements.txt
 ├───.ebextensions
 │     └───django.config
 └───isoVisDev

</code></pre>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h2 id="initiate-the-elastic-beanstalk-application"><a class="header" href="#initiate-the-elastic-beanstalk-application">Initiate the Elastic Beanstalk application</a></h2>
<ol>
<li>
<p>Connect to AWS through command prompt by copying the AWS window access paths.</p>
<pre><code>SET AWS_ACCESS_KEY_ID=&lt;aws_access_key_id&gt;
SET AWS_SECRET_ACCESS_KEY=&lt;aws_secret_access_key&gt;
SET AWS_SESSION_TOKEN=&lt;aws_session_token&gt;
</code></pre>
<blockquote>
<p><strong>Note:</strong> The AWS access keys update every now and then, so need to copy the access keys frequently and paste into the Windows command prompt.</p>
</blockquote>
<ul>
<li>
<p>Use the administrative access if possible.
<img src="Deployment/../Images/AwsAccess.jpg" alt="AwsAccess" /></p>
</li>
<li>
<p>Copy the keys from the Windows tab, under Option 1.
<img src="Deployment/../Images/AwsAccess2.jpg" alt="AwsAccess2" /></p>
</li>
</ul>
</li>
<li>
<p>Set up the eb platform.</p>
<pre><code class="language-shell">eb platform select 

Select a platform.
1) .NET Core on Linux
2) .NET on Windows Server
3) Docker
4) Go
5) Java
6) Node.js
7) PHP
8) Packer
9) Python
10) Ruby
11) Tomcat
(make a selection): 9 # Python

Select a platform branch.
1) Python 3.11 running on 64bit Amazon Linux 2023
2) Python 3.9 running on 64bit Amazon Linux 2023
3) Python 3.8 running on 64bit Amazon Linux 2
4) Python 3.7 running on 64bit Amazon Linux 2 (Deprecated)
(default is 1): 1
</code></pre>
</li>
<li>
<p>Initiate the Elastic Beanstalk application, which creates a config.yml.</p>
<pre><code class="language-shell">eb init -p python-3.11 isoVisDev
</code></pre>
<blockquote>
<p><strong>Note:</strong> Ensure that the region is correct (matching with region stated in the AWS web) in the config.yml</p>
</blockquote>
<p>The config.yml is created in the .elasticbeanstalk folder.</p>
<pre><code> isoVisDev
 ├───manage.py
 ├───requirements.txt
 ├───.ebextensions
 |     ├───django.config
 ├───.elasticbeanstalk
 |     ├───config.yml  
 └───isoVisDev
</code></pre>
<p>And the content of the config.yml:</p>
<pre><code class="language-yaml">branch-defaults:
  default:
    environment: isoVisDev
    group_suffix: null
  main:
    environment: isoVisDev
global:
  application_name: isoVisDev
  branch: null
  default_ec2_keyname: null
  default_platform: Python 3.11
  default_region: eu-north-1        # change this region
  include_git_submodules: true
  instance_profile: null
  platform_name: null
  platform_version: null
  profile: null
  repository: null
  sc: null
  workspace_type: Application
</code></pre>
</li>
<li>
<p>Create Elastic Beanstalk environment to run application.</p>
<pre><code class="language-shell">eb create isoVisDev-env --region eu-north-1 
eb status
</code></pre>
<blockquote>
<p><strong>Note:</strong> This creates the isoVisDev-env. Replace this with the name of environment to create.</p>
</blockquote>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="verifying-deployment"><a class="header" href="#verifying-deployment">Verifying Deployment</a></h1>
<h2 id="via-eb-cli"><a class="header" href="#via-eb-cli">via EB-CLI</a></h2>
<p>The status of the Elastic Beanstalk environment can be checked on the windows terminal:</p>
<pre><code class="language-markdown">&gt; eb list
Environment details for: isoVis-env
  Application name: isoVisDev
  Region: eu-north-1
  Deployed Version: app-1fe2-240926_180444424798
  Environment ID: e-dqvv825srf
  Platform: arn:aws:elasticbeanstalk:eu-north-1::platform/Python 3.11 running on 64bit Amazon Linux 2023/4.0.11
  Tier: WebServer-Standard-1.0
  CNAME: isoVis-deploy-env.eba-r7r9zsja.eu-north-1.elasticbeanstalk.com
  Updated: 2024-09-26 17:23:17.866000+00:00
  Status: Ready
  Health: Grey
Alert: The platform version that your environment is using isn't recommended. There's a recommended version in the same platform branch.

</code></pre>
<p>The list of environments can be checked with:</p>
<pre><code class="language-markdown">&gt; eb list
* isoVis-env  # showing that we are using this environment
isoVis2-env
</code></pre>
<p>To switch environments:</p>
<pre><code class="language-markdown">&gt; eb use isoVis2-env
&gt; eb list
isoVis-env  
* isoVis2-env
</code></pre>
<p>To open the application on the platform:</p>
<pre><code class="language-markdown">&gt; eb open
</code></pre>
<h2 id="via-aws-web"><a class="header" href="#via-aws-web">via AWS web</a></h2>
<ol>
<li>
<p>Log into AWS, and click on <span class="button">Access</span> rather than <span class="button">Access keys</span>.
<img src="Deployment/../Images/awsAccess3.jpg" alt="Access3" /></p>
</li>
<li>
<p>Search for <span class="search">Elastic Beanstalk</span> on the opened AWS web.
<img src="Deployment/../Images/elasticbeanstalk.jpg" alt="elasticbeanstalk" /></p>
</li>
<li>
<p>This will open up the applications and environments initiated. Hopefully, the application and environment created is listed.
<img src="Deployment/../Images/elasticbeanstalk2.jpg" alt="elasticbeanstalk2" /></p>
</li>
<li>
<p>Click on the application, and the domain to open the application.
<img src="Deployment/../Images/elasticbeanstalk3.jpg" alt="elasticbeanstalk3" /></p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="change-domain-name"><a class="header" href="#change-domain-name">Change Domain name</a></h1>
<p>While the application is successfully deployed, the domain name will be some long string of letters (for example: isoVis-deploy-env.eba-r7r9zsja.eu-north-1.elasticbeanstalk.com).</p>
<p>To change the name of the domain with a bought domain name (i.e. from GoDaddy), Route53 is used for DNS routing.</p>
<h2 id="set-up-route-53-on-aws"><a class="header" href="#set-up-route-53-on-aws">Set up Route 53 on AWS</a></h2>
<ol>
<li>
<p>Search for <span class="search">Route 53</span> app on AWS web.
<img src="Deployment/../Images/route53.jpg" alt="Route53_1" /></p>
</li>
<li>
<p>Click on the <span class="button">Hosted zones</span> on the left-hand side tab of Route 53, and click on <span class="button">Created hosted zone</span>.
<img src="Deployment/../Images/route53_2.jpg" alt="Route53_2" /></p>
</li>
<li>
<p>This will bring a pop-up window. Type in the  <span class="search">domain name of interest</span> in the <span class="button">Domain name</span>
<img src="Deployment/../Images/route53_2.jpg" alt="Route53_3" /></p>
<blockquote>
<p><strong>Note:</strong> isoforms.com is the bought name from GoDaddy.
Click <span class="button">Created hosted zone</span>.</p>
</blockquote>
</li>
<li>
<p>This will take you back to the screen with the <span class="button">hosted zones</span>. Click on the domain created, which will bring you to this page.
<img src="Deployment/../Images/route53_2.jpg" alt="Route53_4" /></p>
<blockquote>
<p><strong>Important:</strong> The <span class="code">Name server</span> listed here needs to be copied and added to the GoDaddy domain.</p>
</blockquote>
</li>
<li>
<p>To link the Elastic Beanstalk application with the nameserver, click on <span class="button">Create record</span>.</p>
</li>
<li>
<p>This will bring up another page. Select <span class="button">Simple routing</span>, click <span class="button">Next</span>.
<img src="Deployment/../Images/route53_5.jpg" alt="Route53_5" /></p>
</li>
<li>
<p>Click <span class="button">Define simple record</span>.
<img src="Deployment/../Images/route53_6.jpg" alt="Route53_5" /></p>
</li>
<li>
<p>This will bring up another pop-up page.</p>
<ul>
<li>Keep the subdomain blank.</li>
<li>Select <span class="code">A - Routes traffic to an IPv4 address and some AWS resources</span> under <span class="button">Record type</span>.</li>
<li>Select <span class="code">Alias to Elastic Beanstalk enviroment</span> under <span class="button">Value/Route traffic</span>.</li>
<li>Select the region that the environment was created (in this case, eu-north-1).</li>
<li>The Elastic Beanstalk environment created shoud be listed.</li>
<li>Click on <span class="button">Define simple record</span>.
<img src="Deployment/../Images/route53_6.jpg" alt="Route53_5" /></li>
</ul>
</li>
<li>
<p>Depending on the application size, this can take up to a few hours for the DNS nameserver to update.</p>
</li>
</ol>
<h2 id="change-nameservers-on-godaddy"><a class="header" href="#change-nameservers-on-godaddy">Change nameservers on GoDaddy</a></h2>
<p>The nameservers listed on AWS need to be copied on the GoDaddy domain. A step-to-step guide to do this can be found on this <a href="https://www.godaddy.com/en-uk/how-to/introduction-to-domains-at-godaddy/how-to-change-domain-nameservers">video</a> or <a href="https://www.godaddy.com/en-uk/help/edit-my-domain-nameservers-664">document</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="django-development"><a class="header" href="#django-development">Django Development</a></h1>
<p>As described in the Deployment section, a simple Django project structure is created with:</p>
<pre><code class="language-shell">django-admin startproject isoVisDev 
</code></pre>
<p>Following the steps to deploy the application AWS successfully, the following tree structure should be as of follows:</p>
<pre><code class="language-plaintext">isoVisDev/
├── manage.py
├── requirements.txt
├── .ebextensions/
│   └── django.config
├── .elasticbeanstalk/
│   └── config.yml
└── isoVisDev/
    ├── asgi.py
    ├── settings.py
    ├── urls.py
    └── wsgi.py
</code></pre>
<h2 id="guide"><a class="header" href="#guide">Guide</a></h2>
<p>This next section is a guide to create a more functioning Django application:</p>
<ul>
<li>covering the basic folder structure for live rendering</li>
<li>creating a basic homepage and two tabs</li>
<li>interactive widgets and filtering using a SQLite database</li>
<li>plotting with python and Rscripts</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="basic-commands"><a class="header" href="#basic-commands">Basic commands</a></h1>
<p><span class="code">python manage.py runserver</span>.<br></p>
<div style="margin-left: 20px;">For running the Django application</div>
<p><span class="code">python manage.py makemigrations</span><br></p>
<div style="margin-left: 20px;">Updates changes made in the <code>models.py</code>. Version control of the changes are documented in the <code>migrations</code> folder.</div>
<p><span class="code">python manage.py makemigrations expression </span><br></p>
<div style="margin-left: 20px;">Update changes made in the <code>models.py</code> for a tab within the app, named <code>expression</code>.</div>
<p><span class="code">python manage.py migrate</span><br></p>
<div style="margin-left: 20px;"> Ran after <code>python manage.py makemigrations</code> and applies the migrations to the database, effectively updating the database schema to match current models.</div>
<p><span class="code">python manage.py &lt;python.script&gt;</span><br></p>
<div style="margin-left: 20px;"> Run <code>python script</code>, which may upload a csv file to the database </div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="cheatsheet"><a class="header" href="#cheatsheet">Cheatsheet</a></h1>
<p><a href="Django/djangoTemplates.html">Modify text in homepage</a> - change the <code>home.html</code>.</p>
<p><a href="Django/djangoModule.html">Create a module</a></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="project-overview"><a class="header" href="#project-overview">Project Overview</a></h1>
<p>The overarching settings and urls are noted in the <code>settings.py</code> and <code>urls.py</code> in the <code>app</code> (in this case, isoVisDev) subfolder.</p>
<pre><code class="language-plaintext">isoVisDev/
|
├── manage.py
|
└── isoVisDev/
	|
    ├── asgi.py
    |
    ├── settings.py      # overview settings
    |
    ├── urls.py          # overview urls
    |
    └── wsgi.py
</code></pre>
<p>These two files need to be configured correctly before developing the project.</p>
<h2 id="base-structure-and-style"><a class="header" href="#base-structure-and-style">Base structure and style</a></h2>
<p>To generate the base structure (i.e. the tabs and individual pages) and set-up the design, create a new folder called <span class="button">templates</span>, and generate two files in the folder (<code>base.html</code> and <code>home.html</code>):</p>
<pre><code class="language-plaintext">isoVisDev/
|
├── manage.py
|
└── isoVisDev/
|	|
|   ├── asgi.py
|   |
|   ├── settings.py      # overview settings
|   |
|   ├── urls.py          # overview urls
|   |
|   └── wsgi.py
|
└── templates
	|
	├── base.html
	|
	└── home.html
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="project-settings"><a class="header" href="#project-settings">Project settings</a></h1>
<p>The <code>settings.py</code> file holds the configuration settings for the Django application, and only needs to be configured at the start of the project.</p>
<p>While the <code>django-admin</code> will create the basic template of the file, there are a few things that need to be updated accordingly:</p>
<ol>
<li>
<p><strong>Allowed Hosts</strong></p>
<p><span class="code">ALLOWED_HOSTS</span>: A list of strings representing the host/domain names for the Django app.</p>
<blockquote>
<p><strong>Note</strong>: This is empty in the template, and needs to include the Elastic Beanstalk domain and the preferred domain name.</p>
</blockquote>
<pre><code class="language-python">ALLOWED_HOSTS = ['isoforms.com','www.isoforms.com','127.0.0.1','isoVis-deploy-env.eba-r7r9zsja.eu-north-1.elasticbeanstalk.com']
</code></pre>
</li>
<li>
<p><strong>Apps</strong></p>
<p><span class="code">INSTALLED_APPS</span>: A list of the sub-applications created (i.e expression here), and third-party apps</p>
<blockquote>
<p><strong>Note</strong>: <code>expression.apps.expressionConfig</code>: needs to be an <code>app.py</code> in the <code>expression</code> folder.</p>
</blockquote>
<pre><code class="language-python">INSTALLED_APPS = [
	#### In template
    'django.contrib.admin',  
    # Built-in admin interface
    'django.contrib.auth',         					
    # Authentication framework
    'django.contrib.contenttypes', 					
    # Content type framework
    'django.contrib.sessions',      				
    # Session framework
    'django.contrib.messages',     					
    # Messaging framework
    'django.contrib.staticfiles',   				
    # Static file handling

    ### Added by user
    # Your custom app
    'expression.apps.expressionConfig',     
    # Third-party app for REST APIs        
    'import_export',       					
]
</code></pre>
</li>
<li>
<p><strong>Language and Time Zone</strong></p>
<p>Update this to the language and time zone as appropriate.</p>
<pre><code class="language-python">LANGUAGE_CODE = 'en-gb'
TIME_ZONE = 'Europe/London'
</code></pre>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="templates"><a class="header" href="#templates">Templates</a></h1>
<p>The templates folder creates the backbone of the dynamic HTML pages. There are two files:</p>
<pre><code class="language-plaintext">isoVisDev/
├── manage.py
└── isoVisDev/
|   ├── asgi.py
|   ├── settings.py      
|   ├── urls.py          
|   └── wsgi.py
└── templates
	├── base.html     # file 1
	└── home.html     # file 2
</code></pre>
<h2 id="basehtml"><a class="header" href="#basehtml"><span class="code">base.html</span></a></h2>
<p>The code below in the <code>base.html</code> is used to create the style and tabs:</p>
<p><img src="Django/../Images/DjangoBookmark.jpg" alt="bookmark" /></p>
<pre><code class="language-html">{% raw %}
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
  &lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;
    &lt;link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"&gt;

    &lt;!-- INSERT ADITIONAL INFORMATION TO THE HEAD TAG HERE--&gt;
    {% block head %}
    {% endblock%}

    
 &lt;/head&gt;
  &lt;body&gt;
    &lt;!-- BOOTSTRAP NAVBAR CODE --&gt;
    &lt;nav class="navbar navbar-expand-lg navbar-dark bg-dark"&gt;
        &lt;div class="d-flex justify-content-between px-5 mx-auto" style="width: 90%;"&gt;
            &lt;span class="navbar-text text-white"&gt;Long-Read Brain Transcriptome Dataset&lt;/span&gt;
            &lt;ul class="navbar-nav mr-auto"&gt;
                &lt;li class="nav-item active"&gt;
                    &lt;a class="nav-link active" href="{% url 'home' %}"&gt;Home&lt;/a&gt;
                &lt;/li&gt;
                &lt;li class="nav-item active"&gt;
                    &lt;a class="nav-link active" href="{% url 'expression:summary' %}"&gt;Summary&lt;/a&gt;
                &lt;/li&gt;
                &lt;li class="nav-item active"&gt;
                    &lt;a class="nav-link active" href="{% url 'expression:transcript' %}"&gt;Transcript Level&lt;/a&gt;
                &lt;/li&gt;
            &lt;/ul&gt;
        &lt;/div&gt;
    &lt;/nav&gt;
    &lt;!-- END OF NAVBAR CODE--&gt;


    &lt;div class="container-fluid mt-5" style="max-width: 80%"&gt;    
    &lt;!-- INSERT THE CONTENT FROM SPECIFIC PAGES HERE--&gt;
        {% block content %}
        {% endblock  %}
    &lt;/div&gt;
    
    &lt;script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
{% endraw %}
</code></pre>
<p>To create a new tab (i.e Contact), include the code with appropriate indentation:</p>
<pre><code class="language-html">{% raw %}
&lt;li class="nav-item active"&gt;
    &lt;a class="nav-link active" href="{% url 'contact' %}"&gt;Contact&lt;/a&gt;
&lt;/li&gt;
{% endraw %}
</code></pre>
<p>The <code>contact.html</code> then needs to be placed in the same <code>templates</code> folder.</p>
<blockquote>
<p><strong>Note</strong>: <code>expresion:summary</code> and <code>expression:transcript</code> means that the <code>summary.url</code> and <code>transcript.url</code> are placed in the <code>expression\urls</code> folder, and those sites will be accessed through <span class="search">wwww.isoforms.com\expression\summary</span> and <span class="search">www.isoforms.com\expression\transcriptsummary</span>`</p>
</blockquote>
<h2 id="homehtml"><a class="header" href="#homehtml"><span class="code">home.html</span></a></h2>
<p>The code below in the <code>home.html</code> is used to create the homapage.</p>
<p><img src="Django/../Images/homepage.jpg" alt="bookmark" /></p>
<pre><code class="language-html">{% raw %}
{% extends 'base.html' %}
{% block content %}
&lt;h1&gt;Long read brain transcriptome dataset&lt;/h1&gt;
&lt;br&gt;
We used long-read transcriptome sequencing to characterise the structure and abundance of full-length transcripts in the human cortex from donors aged 6 weeks post-conception to 83 years old. We identified thousands of novel transcripts, with dramatic differences in the diversity of expressed transcripts between prenatal and postnatal cortex. A large proportion of these previously uncharacterised transcripts have high coding potential, with corresponding peptides detected in proteomic data. Novel putative coding sequences are highly conserved and overlap de novo mutations in genes linked with neurodevelopmental disorders in individuals with relevant clinical phenotypes. Our findings underscore the potential of novel coding sequences to harbor clinically relevant variants, offering new insights into the genetic architecture of human disease. Our cortical transcript annotations are available as a resource to the research community via an online database

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
Please refer to &lt;a href="https://www.biorxiv.org/content/10.1101/2024.09.09.612016v1"&gt; Bamford et al. 2024 &lt;/a&gt; and the 
&lt;a href="https://genome.ucsc.edu/cgi-bin/hgTracks?db=hg38&amp;lastVirtModeType=default&amp;lastVirtModeExtraState=&amp;virtModeType=default&amp;virtMode=0&amp;nonVirtPosition=&amp;position=chr6%3A105273218%2D105403082&amp;hgsid=2355395487_u493yeIu7Ry5BcMRNmxfUqkeKryA"&gt; transcripts detected on UCSC Genome Browser&lt;/a&gt;.

{% endblock  %}
{% endraw %}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="project-urls"><a class="header" href="#project-urls">Project urls</a></h1>
<p>The project <code>urls.py</code> list routes URLs to views.</p>
<pre><code class="language-python"># urls.py
from django.contrib import admin
from django.urls import path, include
from expression import views

urlpatterns = [
    path('', views.home, name='home'),
    path('admin/', admin.site.urls),
    path('expression/', include('expression.urls'))
]
</code></pre>
<h3 id="description"><a class="header" href="#description">Description</a></h3>
<p><span class="code">from django.contrib import admin</span>
This imports the Django admin module to create the interfance for managing application's data.</p>
<p><span class="code">urlpatterns[]</span>
List of all the URL patterns for Django application, i.e. <code>isoforms.com</code>, <code>isoforms.com\admin</code>, <code>isoforms.com\expression</code></p>
<p><span class="code">path('expression/', include('expression.urls'))</span>
Includes additional URL patterns from the expression.urls module (listed in the <code>expression\urls.py</code>)</p>
<blockquote>
<p><strong>NOTE</strong>: Important to update the urlpatterns everytime a new module/sub-folder is added.</p>
</blockquote>
<h3 id="adding-new-module"><a class="header" href="#adding-new-module">Adding new module</a></h3>
<p>If adding a new module called <code>Structure</code>, the new <code>urls.py</code> would be:</p>
<pre><code class="language-python"># urls.py
from django.contrib import admin
from django.urls import path, include
from expression import views

urlpatterns = [
    path('', views.home, name='home'),
    path('admin/', admin.site.urls),
    path('expression/', include('expression.urls')),
    path('structure/', include('structure.urls'))
]
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="add-module"><a class="header" href="#add-module">Add module</a></h1>
<p>To create a <code>module</code> or <code>app</code> within the Django application, i.e <span class="search">www.isoforms.com/expression/</span>, a separate folder called <code>expression</code> needs to be created in the main folder, with all the other template htmls.</p>
<p>To integrate this to the existing Django application:</p>
<ol>
<li>
<p>Open the <a href="Django/../Deployment/installation.html">Windows command prompt</a> and change directory to the project folder.</p>
</li>
<li>
<p>Create the module <code>expression</code></p>
<pre><code class="language-shell">cd C:\Users\sl693\Dropbox\Scripts\isoVisDev
python manage.py startapp expression 
</code></pre>
<p>This command will create the following structure:</p>
<pre><code class="language-plaintext">isoVisDev/
└── expression/
    ├── migrations/
    ├── __init__.py
    ├── admin.py
    ├── apps.py
    ├── models.py
    ├── tests.py
    └── views.py
</code></pre>
</li>
<li>
<p>Link the module to the Django app
The module needs to be registered in the <code>settings.py</code> and <code>urls.py</code> in the main folder.</p>
<pre><code class="language-plaintext"> isoVisDev/
 ├── manage.py
 └── isoVisDev/
     ├── asgi.py
     ├── settings.py      # modify this
     ├── urls.py          # modify this
     └── wsgi.py
 └── expression/
     ├── migrations/
     ├── __init__.py
     ├── admin.py
     ├── apps.py
     ├── models.py
     ├── tests.py
     └── views.py
</code></pre>
<p>In the <span class="code">settings.py</span>, add the module to the <span class="code">INSTALLED_APPS</span>, as described <a href="Django/djangoSettings.html">here</a>.</p>
<p>In the <span class="code">urls.py</span>, include the urls to the <span class="code">urlpatterns</span>, as described <a href="Django/djangoUrls.html">here</a>.</p>
</li>
<li>
<p>Modify the <span class="code">views.py</span>
Add the below to the <code>view.py</code>. The <span class="search">www.isoforms.com/expression</span> will automatically direct to the <code>home.html</code> page defined in the main <a href="Django/djangoTemplates.html">app</a>.</p>
<pre><code class="language-python"># expression/views.py

from django.shortcuts import render, redirect, get_object_or_404
from django.http import JsonResponse
from django.urls import reverse

def home(request):
	return render(request, 'home.html')

</code></pre>
</li>
<li>
<p>Create other pages within this module
Create a new file called <code>urls.py</code> and define the other url paths:</p>
<pre><code class="language-python"> from django.urls import path
 from . import views

 app_name = 'expression'
 urlpatterns = [
 	path('', views.summary, name='main'),
 	path('summary/', views.summary, name= 'summary'),
 	path('transcript/', views.transcript_identify, name= 'transcript')
 ]
</code></pre>
<p>Notes:</p>
<ul>
<li>The module name here is called <code>expression</code>.</li>
<li>the <code>views.summary</code> refers to the <code>def summary()</code> in the <code>expression/view.py</code>, which can be accessed with <span class="search">www.isoforms.com/expression.summary</span></li>
</ul>
</li>
<li>
<p>Run migrations</p>
<p>Finalise the module, by typing the following  in the Windows terminal:</p>
<pre><code class="language-shell">cd C:\Users\sl693\Dropbox\Scripts\isoVisDev
python manage.py makemigrations expression
python manage.py migrate
</code></pre>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><h1 id="add-files-to-database"><a class="header" href="#add-files-to-database">Add files to database</a></h1>
<p>In most uses of a web application, we will need to have a database where we can retrieve information. This is stored in the form of a SQLite database (<code>db.sqlite3</code>), which is referred in the <span class="code">DATABASES</span> in the <code>settings.py</code>.</p>
<p>The database can either be populated using the Django admin site or directly through the app by loading csv/txt files, as guided below:</p>
<h2 id="set-up"><a class="header" href="#set-up">Set up</a></h2>
<ol>
<li>
<p>Deposit the <code>.csv</code> file in the apps folder, within the <code>files</code> directory (need to create directory).</p>
</li>
<li>
<p>Create a <code>.py</code> script to load the csv file, within <code>management\commands</code> directory (need to create directories).</p>
<p>An example of the folder structure:</p>
<pre><code>	isoVisDev/
	├── manage.py
 └── expression/
 	└── files/
 		└── whole_gene_counts.csv   # deposit this csv file here 
 	├── management/
 		└── commands/
 			└── load_gene_counts.py   # create this script 
     ├── migrations/
     ├── __init__.py
     ├── admin.py
     ├── apps.py
     ├── models.py
     ├── tests.py
     └── views.py
</code></pre>
<p>In the <code>load_gene_counts.py</code> script:</p>
<pre><code class="language-python">from csv import DictReader   
from django.core.management import BaseCommand

# Import the model 
from expression.models import Genecounts

class Command(BaseCommand):
    # Show this when the user types help
    help = "Loads data from whole_genecounts.csv"

    def handle(self, *args, **options):
    	            
        # Show this before loading the data into the database
        print("Loading gene counts data")

        #Code to load the data into database
        for row in DictReader(open('./expression/files/whole_genecounts.csv')):
            Genecount=Genecounts(sampleID=row['sampleID'], geneName=row['geneName'], counts=row['counts'], group=row['group'], sex = row['sex']) 
            Genecount.save()
    
    def __str__(self):
        return self.title  
</code></pre>
</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
